import{c as ce,r as d,j as e,m as W,i as D,R as se,e as B,a as Fe,C as hs,u as fs}from"./main-99bb4b09.js";import{u as be,C as de,a as me,X as ps,l as gs,at as js,c as I,f as _,au as vs,M as Ee,av as Ns,aw as ys,ax as Ce,_ as bs,$ as Cs,a0 as ws,a1 as Ss,a2 as we,d as ne,e as ie,g as Ps,ar as As,h as Is,ay as Ds,az as ks,aA as Se,aB as Fs,aC as Es,V as Ts,a5 as ue,ai as Ls,aD as Te,Y as Pe,B as Rs,a7 as Le,am as Ms,ao as $s,ap as _s,af as Os,ah as Vs,ab as te,a9 as Bs,b as zs,L as re}from"./badge-e5e69992.js";import{S as Q,E as Us}from"./skeleton-e5d5cc1c.js";import{B as j,I as N,a as K,L as z,c as C,P as E}from"./loading-spinner-1f4ff308.js";import{M as Gs}from"./mail-9deaecef.js";import{P as Hs}from"./phone-ade08aae.js";import{P as Ws}from"./package-fc788644.js";import"./user-2488036d.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Ys=ce("CalendarDays",Ks);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Xs=ce("CreditCard",qs);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Qs=ce("LogOut",Js);function Zs({predictions:s,onSelect:a,isSearching:r,onClose:t}){if(s.length===0&&!r)return null;const i=n=>{a(n),t()};return e.jsx(Ns,{children:e.jsx(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute left-0 right-0 top-full z-[9999] mt-1",children:e.jsx(W.div,{className:"mx-4 overflow-hidden rounded-lg border bg-background/95 backdrop-blur-sm shadow-lg",layout:!0,children:r?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(K,{size:24})}):e.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"max-h-[300px] overflow-y-auto p-1",children:s.map(n=>e.jsxs(W.button,{onClick:()=>i(n),className:C("w-full rounded-md p-3 text-left text-sm transition-colors","hover:bg-accent/80 hover:text-accent-foreground","focus:bg-accent/80 focus:text-accent-foreground focus:outline-none"),whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("span",{className:"font-medium",children:n.place_name.split(",")[0]}),e.jsx("span",{className:"block truncate text-xs text-muted-foreground",children:n.place_name.split(",").slice(1).join(",")})]},n.id))})})})})}function ea({open:s,onOpenChange:a,onAddressSelect:r,initialCenter:t=[-73.935242,40.73061]}){const[i,n]=d.useState(""),[c,l]=d.useState([]),[m,o]=d.useState(!1),[x,u]=d.useState(!1),[v,T]=d.useState(t),[p,w]=d.useState(t),[b,O]=d.useState(null),[Y,q]=d.useState(!1),[h,F]=d.useState(!1),L=be(i,300),R=be(p,1e3),S=d.useCallback(f=>{var M,H,X,J,je,ve,Ne,ye;const g={streetAddress:f.place_name.split(",")[0],city:((H=(M=f.context)==null?void 0:M.find($=>$.id.startsWith("place")))==null?void 0:H.text)||"",region:((J=(X=f.context)==null?void 0:X.find($=>$.id.startsWith("region")))==null?void 0:J.text)||"",postalCode:((ve=(je=f.context)==null?void 0:je.find($=>$.id.startsWith("postcode")))==null?void 0:ve.text)||"",country:((ye=(Ne=f.context)==null?void 0:Ne.find($=>$.id.startsWith("country")))==null?void 0:ye.text)||"",coordinates:f.center};O(g),T(f.center),w(f.center),F(!1)},[]);d.useEffect(()=>{(async()=>{if(!L){l([]);return}o(!0);try{const g=await ys(L);l(g)}catch(g){console.error("Error searching addresses:",g)}finally{o(!1)}})()},[L]),d.useEffect(()=>{(async()=>{if(R)try{const g=await Ce(R[0],R[1]);g&&S(g)}catch(g){console.error("Error reverse geocoding:",g)}})()},[R,S]);const y=async()=>{q(!0);try{const f=await new Promise((X,J)=>{navigator.geolocation.getCurrentPosition(X,J,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}),{longitude:g,latitude:M}=f.coords,H=await Ce(g,M);H&&S(H)}catch(f){console.error("Error getting user location:",f)}finally{q(!1)}},V=d.useCallback((f,g)=>{w(f),u(g),g||(F(!0),T(f))},[]),us=()=>{b&&(r(b),a(!1),n(""),l([]),O(null))};d.useEffect(()=>{s||(n(""),l([]),O(null))},[s]);const G=(f,g)=>{b&&O(M=>M&&{...M,[f]:g})},xs=d.useCallback(()=>{n(""),l([])},[]);return e.jsx(de,{open:s,onOpenChange:a,children:e.jsxs(me,{className:"flex h-full max-w-full flex-col gap-0 border-none p-0",children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Address"}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>a(!1),children:e.jsx(ps,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-grow flex-col overflow-y-auto p-4",children:[e.jsxs("div",{className:"relative mb-4 flex items-center space-x-2",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(gs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(N,{value:i,onChange:f=>n(f.target.value),placeholder:"Search for an address...",className:"pl-9"}),e.jsx(Zs,{predictions:c,onSelect:S,isSearching:m,onClose:xs})]}),e.jsx(j,{variant:"outline",size:"icon",onClick:y,disabled:Y,children:Y?e.jsx(K,{size:16}):e.jsx(js,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid flex-grow grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsx(I,{className:"h-full",children:e.jsx(_,{className:"h-full p-0",children:e.jsx(vs,{center:p,onMove:V})})}),e.jsx(I,{className:"h-full",children:e.jsx(_,{className:"space-y-4 p-4",children:b?e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Street Address"}),e.jsx(N,{value:b.streetAddress,onChange:f=>G("streetAddress",f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"City"}),e.jsx(N,{value:b.city,onChange:f=>G("city",f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Region"}),e.jsx(N,{value:b.region,onChange:f=>G("region",f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Postal Code"}),e.jsx(N,{value:b.postalCode,onChange:f=>G("postalCode",f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Country"}),e.jsx(N,{value:b.country,onChange:f=>G("country",f.target.value)})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:e.jsx("p",{children:"Search for an address or select a location on the map"})})})})]})]}),e.jsxs("div",{className:"flex justify-between border-t p-4",children:[e.jsx(j,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(j,{onClick:us,disabled:!b,children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Confirm Address"]})]})]})})}function le({name:s,label:a,description:r,addressType:t}){var u;const{profile:i,isLoading:n,setIsAddressDialogOpen:c,setSelectedAddressType:l}=D(),m=()=>{l(t),c(!0)},o=t==="billing"?i==null?void 0:i.billingAddress:(u=i==null?void 0:i.company)==null?void 0:u.address,x=o?`${o.street}, ${o.city}, ${o.state}, ${o.postalCode}, ${o.country}`:r||"Enter address";return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:a}),e.jsx("div",{className:"text-sm text-muted-foreground",children:x})]}),e.jsxs(j,{type:"button",variant:"outline",size:"sm",onClick:m,disabled:n,children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),o?"Change":"Add"]})]}),o&&e.jsxs("div",{className:"rounded-md border p-3 text-sm",children:[e.jsx("div",{children:o.street}),e.jsxs("div",{children:[o.city,", ",o.state," ",o.postalCode]}),e.jsx("div",{children:o.country})]})]})}const sa=se.createContext(null),aa=()=>se.useContext(sa),ta=d.createContext({}),ra=()=>{const s=d.useContext(ta),a=d.useContext(na),{getFieldState:r,formState:t}=aa(),i=r(s.name,t);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:n}=a;return{id:n,name:s.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...i}},na=d.createContext({}),P=d.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:C("space-y-2",s),...a}));P.displayName="FormItem";const A=d.forwardRef(({className:s,...a},r)=>e.jsx(z,{ref:r,className:C("",s),...a}));A.displayName="FormLabel";const k=d.forwardRef(({...s},a)=>e.jsx("div",{ref:a,...s}));k.displayName="FormControl";const ia=d.forwardRef(({className:s,...a},r)=>{const{formDescriptionId:t}=ra();return e.jsx("p",{ref:r,id:t,className:C("text-sm text-muted-foreground",s),...a})});ia.displayName="FormDescription";const U=d.forwardRef(({className:s,children:a,...r},t)=>a?e.jsx("p",{ref:t,className:C("text-sm font-medium text-destructive",s),...r,children:a}):null);U.displayName="FormMessage";function la(){var n,c;const{formValues:s,formErrors:a,isLoading:r,setFormValue:t}=D(),i=(l,m)=>{s.company&&t("company",{...s.company,metadata:{...s.company.metadata,[l]:m}})};return s.company?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(P,{children:[e.jsx(A,{children:"Company Name"}),e.jsx(k,{children:e.jsx(N,{placeholder:"Company Name",value:s.company.name,onChange:l=>{s.company&&t("company",{...s.company,name:l.target.value})},disabled:r})}),a.company&&e.jsx(U,{children:a.company})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Registration Number"}),e.jsx(k,{children:e.jsx(N,{placeholder:"Registration Number",value:s.company.registrationNumber,onChange:l=>{s.company&&t("company",{...s.company,registrationNumber:l.target.value})},disabled:r})})]}),e.jsxs(P,{children:[e.jsx(A,{children:"VAT Number (Optional)"}),e.jsx(k,{children:e.jsx(N,{placeholder:"VAT Number",value:s.company.vatNumber,onChange:l=>{s.company&&t("company",{...s.company,vatNumber:l.target.value})},disabled:r})})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Tax ID (Optional)"}),e.jsx(k,{children:e.jsx(N,{placeholder:"Tax ID",value:((n=s.company.metadata)==null?void 0:n.taxId)||"",onChange:l=>i("taxId",l.target.value),disabled:r})})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Website (Optional)"}),e.jsx(k,{children:e.jsx(N,{placeholder:"https://example.com",value:((c=s.company.metadata)==null?void 0:c.website)||"",onChange:l=>i("website",l.target.value),disabled:r})})]}),e.jsx(le,{name:"company.address",label:"Company Address",description:"Enter your company address",addressType:"company"})]}):null}const oa={name:"",registrationNumber:"",vatNumber:"",address:{street:"",city:"",state:"",country:"",postalCode:""}};function ca(){const{formValues:s,formErrors:a,isLoading:r,setFormValue:t}=D(),i=n=>{t("company",n?oa:void 0)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(P,{children:[e.jsx(A,{children:"First Name"}),e.jsx(k,{children:e.jsx(N,{placeholder:"John",value:s.firstName,onChange:n=>t("firstName",n.target.value),disabled:r})}),a.firstName&&e.jsx(U,{children:a.firstName})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Last Name"}),e.jsx(k,{children:e.jsx(N,{placeholder:"Doe",value:s.lastName,onChange:n=>t("lastName",n.target.value),disabled:r})}),a.lastName&&e.jsx(U,{children:a.lastName})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Email"}),e.jsx(k,{children:e.jsx(N,{type:"email",placeholder:"john@example.com",value:s.email,onChange:n=>t("email",n.target.value),disabled:r})}),a.email&&e.jsx(U,{children:a.email})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Phone"}),e.jsx(k,{children:e.jsx(N,{type:"tel",placeholder:"+1234567890",value:s.phoneNumber,onChange:n=>t("phoneNumber",n.target.value),disabled:r})}),a.phoneNumber&&e.jsx(U,{children:a.phoneNumber})]}),e.jsxs(P,{children:[e.jsx(A,{children:"Register as Company?"}),e.jsxs(bs,{value:s.company?"yes":"no",onValueChange:n=>i(n==="yes"),disabled:r,children:[e.jsx(Cs,{children:e.jsx(ws,{placeholder:"Do you want to register as a company?"})}),e.jsxs(Ss,{children:[e.jsx(we,{value:"no",children:"No"}),e.jsx(we,{value:"yes",children:"Yes"})]})]})]})]})}function da(){const{subscription:s,subscriptionPlans:a,isLoading:r,error:t,selectedPlan:i,setSelectedPlan:n}=D(),c=()=>r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(K,{size:40})}):t?e.jsx("div",{className:"text-red-500",children:t}):a!=null&&a.length?e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:a.map(l=>{const m=l.pricingIntervals.find(u=>u.isDefault);if(!m)return null;const o=(i==null?void 0:i.id)===l.id,x=(s==null?void 0:s.plan)===l.id;return e.jsxs(I,{className:o||x?"border-primary":"",children:[e.jsxs(ne,{children:[e.jsx(ie,{children:l.name}),e.jsxs(Ps,{children:["$",m.price,"/",m.interval]})]}),e.jsx(_,{children:e.jsx("ul",{className:"space-y-2",children:l.features.map((u,v)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx(As,{className:"mr-2 h-4 w-4 text-green-500"}),u]},v))})}),e.jsx(Is,{children:e.jsx(j,{className:"w-full",onClick:()=>n(l),disabled:x,children:x?"Current Plan":o?"Selected":"Select Plan"})})]},l.id)})}):e.jsx("div",{children:"No subscription plans available."});return e.jsx("div",{className:"space-y-6",children:c()})}function ma({closeButton:s}){const{formValues:a,isLoading:r,isAddressDialogOpen:t,setIsAddressDialogOpen:i,selectedAddressType:n,currentStep:c,setCurrentStep:l,isContactLoading:m,businessCardImage:o,setIsContactLoading:x,setBusinessCardImage:u,handleNext:v,handleBack:T,setFormValue:p}=D(),w=se.useRef(null),b=async()=>{var h,F,L,R,S;if(!m)try{if(!((h=Se)!=null&&h.open)){B.error("Contact picker is not available on this platform");return}const y=await Se.open();if(y){const V=y.givenName&&y.familyName?[y.givenName,y.familyName]:(y.displayName||"").split(" ");p("firstName",V[0]||""),p("lastName",V.slice(1).join(" ")||""),p("phoneNumber",((L=(F=y.phoneNumbers)==null?void 0:F[0])==null?void 0:L.phoneNumber)||""),p("email",((S=(R=y.emailAddresses)==null?void 0:R[0])==null?void 0:S.emailAddress)||"")}}catch(y){B.error("Failed to access contacts. Please check permissions."),console.error("Contact picker error:",y)}},O=()=>{w.current&&(w.current.abort(),w.current=null),u(null),B.info("Cancelled contact extraction")},Y=async()=>{if(!m)try{const h=await Fs.getPhoto({quality:90,allowEditing:!0,resultType:Es.Uri});if(h.webPath){u(h.webPath),x(!0);try{w.current=new AbortController;const L=await(await fetch(h.webPath)).blob(),R=new File([L],"business-card.jpg",{type:`image/${h.format}`}),S={name:"John Doe",email:"john@example.com",phoneNumber:"+1234567890",title:"CEO"};if(w.current.signal.aborted)return;const[y,...V]=S.name.split(" ");p("firstName",y),p("lastName",V.join(" ")),p("email",S.email),p("phoneNumber",S.phoneNumber),B.success("Successfully extracted contact information")}catch(F){if(F.name==="AbortError")return;B.error("Failed to extract contact information. Please enter manually."),console.error("Extraction error:",F)}finally{x(!1),w.current=null}}}catch(h){B.error("Failed to capture business card image."),console.error("Camera error:",h)}},q=se.useMemo(()=>{const h=a.billingAddress;return!h||!h.street||!h.city||!h.state||!h.postalCode||!h.country?"Enter your billing address":`${h.street}, ${h.city}, ${h.state} ${h.postalCode}, ${h.country}`},[a.billingAddress]);return r?e.jsx("div",{className:"flex h-[200px] items-center justify-center",children:e.jsx(K,{size:40})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 w-screen px-4",children:[c==="personal"&&e.jsxs(e.Fragment,{children:[e.jsx(ca,{}),o&&e.jsxs("div",{className:"relative w-full h-40 mb-4",children:[e.jsx("img",{src:o,alt:"Business Card",className:"w-full h-full object-contain"}),e.jsx(j,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:O,children:m?"Cancel":"Remove"})]}),e.jsxs("div",{className:"flex gap-1 flex-row w-full justify-between items-center px-2",children:[e.jsxs(j,{type:"button",variant:"outline",onClick:b,className:"w-1/2 md:w-auto",disabled:m,children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Pick from Contacts"]}),e.jsxs(j,{type:"button",variant:"outline",onClick:Y,className:"w-1/2 md:w-auto",disabled:m,children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),m?"Processing...":"Scan Business Card"]})]})]}),c==="company"&&a.company&&e.jsx(la,{}),c==="billing"&&e.jsxs(e.Fragment,{children:[e.jsx(le,{name:"billingAddress",label:"Billing Address",description:q,addressType:"billing"}),a.company&&e.jsx(le,{name:"company.address",label:"Company Address",description:"Enter your company address",addressType:"company"})]}),c==="subscription"&&e.jsx(da,{}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[s&&s,c!=="personal"&&e.jsx(j,{type:"button",variant:"outline",onClick:T,disabled:m,children:"Back"}),e.jsx(j,{type:"button",onClick:v,disabled:m,className:c==="personal"?"ml-auto":"",children:c==="subscription"?"Complete":"Continue"})]})]}),e.jsx(ea,{open:t,onOpenChange:i,onAddressSelect:h=>{n==="billing"?p("billingAddress",{street:h.streetAddress,city:h.city,state:h.region,postalCode:h.postalCode,country:h.country}):n==="company"&&a.company&&p("company",{...a.company,address:{street:h.streetAddress,city:h.city,state:h.region,postalCode:h.postalCode,country:h.country}})}})]})}function Ae(){const{isProfileDialogOpen:s,closeProfileDialog:a}=D();return e.jsx(de,{open:s,onOpenChange:a,children:e.jsxs(me,{className:"h-full w-full flex flex-col justify-between items-center",children:[e.jsx(Ts,{className:"pt-12",children:e.jsx("h1",{className:"text-2xl font-semibold",children:"Update Profile"})}),e.jsx(ma,{closeButton:e.jsx(j,{onClick:a,children:"Close"})}),e.jsx("div",{})]})})}var xe="Avatar",[ua,Ua]=ue(xe),[xa,Re]=ua(xe),Me=d.forwardRef((s,a)=>{const{__scopeAvatar:r,...t}=s,[i,n]=d.useState("idle");return e.jsx(xa,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:n,children:e.jsx(E.span,{...t,ref:a})})});Me.displayName=xe;var $e="AvatarImage",_e=d.forwardRef((s,a)=>{const{__scopeAvatar:r,src:t,onLoadingStatusChange:i=()=>{},...n}=s,c=Re($e,r),l=ha(t,n.referrerPolicy),m=Ls(o=>{i(o),c.onImageLoadingStatusChange(o)});return Te(()=>{l!=="idle"&&m(l)},[l,m]),l==="loaded"?e.jsx(E.img,{...n,ref:a,src:t}):null});_e.displayName=$e;var Oe="AvatarFallback",Ve=d.forwardRef((s,a)=>{const{__scopeAvatar:r,delayMs:t,...i}=s,n=Re(Oe,r),[c,l]=d.useState(t===void 0);return d.useEffect(()=>{if(t!==void 0){const m=window.setTimeout(()=>l(!0),t);return()=>window.clearTimeout(m)}},[t]),c&&n.imageLoadingStatus!=="loaded"?e.jsx(E.span,{...i,ref:a}):null});Ve.displayName=Oe;function ha(s,a){const[r,t]=d.useState("idle");return Te(()=>{if(!s){t("error");return}let i=!0;const n=new window.Image,c=l=>()=>{i&&t(l)};return t("loading"),n.onload=c("loaded"),n.onerror=c("error"),n.src=s,a&&(n.referrerPolicy=a),()=>{i=!1}},[s,a]),r}var Be=Me,ze=_e,Ue=Ve;const Ge=d.forwardRef(({className:s,...a},r)=>e.jsx(Be,{ref:r,className:C("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Ge.displayName=Be.displayName;const fa=d.forwardRef(({className:s,...a},r)=>e.jsx(ze,{ref:r,className:C("aspect-square h-full w-full",s),...a}));fa.displayName=ze.displayName;const He=d.forwardRef(({className:s,...a},r)=>e.jsx(Ue,{ref:r,className:C("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));He.displayName=Ue.displayName;function pa(){var t,i,n,c;const{profile:s,subscription:a}=D(),r=()=>{Fe.getState().logout(),hs.isNativePlatform()?console.log("Logged out in native app"):window.location.href="/login"};return s?e.jsxs("div",{className:"flex flex-col items-center p-6 text-center",children:[e.jsx(Ge,{className:"h-24 w-24",children:e.jsxs(He,{className:"text-xl",children:[(t=s.firstName)==null?void 0:t[0],(i=s.lastName)==null?void 0:i[0]]})}),e.jsxs("div",{className:"mt-4 space-y-1",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[s.firstName," ",s.lastName]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{children:s.phone})]})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"my-4"}),e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Current Plan"}),e.jsxs(Rs,{variant:a.plan==="free"?"secondary":a.plan==="pro"?"default":"destructive",className:"w-full justify-center py-1.5",children:[e.jsx(Xs,{className:"mr-2 h-4 w-4"}),((n=a==null?void 0:a.plan)==null?void 0:n.charAt(0).toUpperCase())+((c=a==null?void 0:a.plan)==null?void 0:c.slice(1))," Plan"]})]})]}),e.jsx(Pe,{className:"my-4"}),e.jsxs(j,{variant:"outline",className:"w-full",onClick:r,children:[e.jsx(Qs,{className:"mr-2 h-4 w-4"}),"Logout"]})]}):null}var he="Tabs",[ga,Ga]=ue(he,[Le]),We=Le(),[ja,fe]=ga(he),Ke=d.forwardRef((s,a)=>{const{__scopeTabs:r,value:t,onValueChange:i,defaultValue:n,orientation:c="horizontal",dir:l,activationMode:m="automatic",...o}=s,x=Ms(l),[u,v]=$s({prop:t,onChange:i,defaultProp:n});return e.jsx(ja,{scope:r,baseId:_s(),value:u,onValueChange:v,orientation:c,dir:x,activationMode:m,children:e.jsx(E.div,{dir:x,"data-orientation":c,...o,ref:a})})});Ke.displayName=he;var Ye="TabsList",qe=d.forwardRef((s,a)=>{const{__scopeTabs:r,loop:t=!0,...i}=s,n=fe(Ye,r),c=We(r);return e.jsx(Os,{asChild:!0,...c,orientation:n.orientation,dir:n.dir,loop:t,children:e.jsx(E.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:a})})});qe.displayName=Ye;var Xe="TabsTrigger",Je=d.forwardRef((s,a)=>{const{__scopeTabs:r,value:t,disabled:i=!1,...n}=s,c=fe(Xe,r),l=We(r),m=es(c.baseId,t),o=ss(c.baseId,t),x=t===c.value;return e.jsx(Vs,{asChild:!0,...l,focusable:!i,active:x,children:e.jsx(E.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":o,"data-state":x?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:m,...n,ref:a,onMouseDown:te(s.onMouseDown,u=>{!i&&u.button===0&&u.ctrlKey===!1?c.onValueChange(t):u.preventDefault()}),onKeyDown:te(s.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&c.onValueChange(t)}),onFocus:te(s.onFocus,()=>{const u=c.activationMode!=="manual";!x&&!i&&u&&c.onValueChange(t)})})})});Je.displayName=Xe;var Qe="TabsContent",Ze=d.forwardRef((s,a)=>{const{__scopeTabs:r,value:t,forceMount:i,children:n,...c}=s,l=fe(Qe,r),m=es(l.baseId,t),o=ss(l.baseId,t),x=t===l.value,u=d.useRef(x);return d.useEffect(()=>{const v=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(v)},[]),e.jsx(Bs,{present:i||x,children:({present:v})=>e.jsx(E.div,{"data-state":x?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":m,hidden:!v,id:o,tabIndex:0,...c,ref:a,style:{...s.style,animationDuration:u.current?"0s":void 0},children:v&&n})})});Ze.displayName=Qe;function es(s,a){return`${s}-trigger-${a}`}function ss(s,a){return`${s}-content-${a}`}var va=Ke,as=qe,ts=Je,rs=Ze;const Na=va,ns=d.forwardRef(({className:s,...a},r)=>e.jsx(as,{ref:r,className:C("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));ns.displayName=as.displayName;const Z=d.forwardRef(({className:s,...a},r)=>e.jsx(ts,{ref:r,className:C("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a}));Z.displayName=ts.displayName;const ee=d.forwardRef(({className:s,...a},r)=>e.jsx(rs,{ref:r,className:C("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));ee.displayName=rs.displayName;function oe(s,a){return new Intl.NumberFormat("en-US",{style:"currency",currency:a.toUpperCase(),minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}function Ie(s){return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function ya(s){return new Intl.NumberFormat("en-US").format(s)}function ba({plans:s,isLoading:a}){const[r,t]=d.useState(null),{fetchPlanPrices:i,planPrices:n,subscribeToPlan:c}=D(),l=async o=>{t(o);try{await i(o)}catch(x){console.error("Error fetching plan prices:",x)}},m=async o=>{if(!n)return;const x=n.subscriptionPrices.find(u=>u.isDefault);if(x)try{await c(o,x.priceId)}catch(u){console.error("Error subscribing to plan:",u)}};return a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(o=>e.jsxs(I,{className:"p-6",children:[e.jsx(Q,{className:"h-8 w-24 mb-4"}),e.jsx(Q,{className:"h-6 w-full mb-2"}),e.jsx(Q,{className:"h-6 w-3/4 mb-4"}),e.jsx("div",{className:"space-y-2",children:[1,2,3].map(x=>e.jsx(Q,{className:"h-4 w-full"},x))})]},o))}):!s||s.length===0?e.jsx("div",{className:"text-center p-6",children:e.jsx("p",{className:"text-gray-500",children:"No subscription plans available at the moment."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Available Plans"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:s.map(o=>{var v,T;const x=r===o.id,u=(v=o.pricingIntervals)==null?void 0:v.find(p=>p.isDefault);return e.jsxs(I,{className:`p-6 cursor-pointer transition-all ${x?"ring-2 ring-primary":""}`,onClick:()=>l(o.id),children:[e.jsx("h4",{className:"text-xl font-semibold mb-2",children:o.name}),e.jsxs("p",{className:"text-3xl font-bold mb-4",children:[oe((u==null?void 0:u.price)||0,o.currency),e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["/",(u==null?void 0:u.interval)||"month"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Included Orders"}),e.jsx("p",{className:"font-medium",children:ya(o.includedOrders||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Price per Extra Order"}),e.jsx("p",{className:"font-medium",children:oe(o.pricePerExtraOrder||0,o.currency)})]}),o.supportLevel&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Support Level"}),e.jsx("p",{className:"font-medium capitalize",children:o.supportLevel})]}),e.jsx("div",{className:"space-y-2",children:(T=o.features)==null?void 0:T.map((p,w)=>e.jsxs("p",{className:"text-sm",children:["✓ ",p]},w))}),e.jsx(j,{className:"w-full",onClick:()=>m(o.id),disabled:!x||!n,children:"Subscribe"})]})]},o.id)})})]})}function Ca({subscription:s}){const{plan:a,startDate:r,endDate:t}=s,i=t?Math.ceil((new Date(t).getTime()-new Date().getTime())/(1e3*60*60*24)):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Plan Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs(I,{children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Ws,{className:"h-4 w-4"}),"Plan Features"]})}),e.jsx(_,{children:e.jsx("ul",{className:"space-y-2",children:a.features.map((n,c)=>e.jsx("li",{className:"text-sm text-muted-foreground",children:n},c))})})]}),e.jsxs(I,{children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Ys,{className:"h-4 w-4"}),"Billing Period"]})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Start Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ie(r)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"End Date"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Ie(t),e.jsxs("span",{className:"ml-2",children:["(",i," ",i===1?"day":"days"," remaining)"]})]})]})]})]})]})]})}var pe="Progress",ge=100,[wa,Ha]=ue(pe),[Sa,Pa]=wa(pe),is=d.forwardRef((s,a)=>{const{__scopeProgress:r,value:t=null,max:i,getValueLabel:n=Aa,...c}=s;(i||i===0)&&!De(i)&&console.error(Ia(`${i}`,"Progress"));const l=De(i)?i:ge;t!==null&&!ke(t,l)&&console.error(Da(`${t}`,"Progress"));const m=ke(t,l)?t:null,o=ae(m)?n(m,l):void 0;return e.jsx(Sa,{scope:r,value:m,max:l,children:e.jsx(E.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":ae(m)?m:void 0,"aria-valuetext":o,role:"progressbar","data-state":cs(m,l),"data-value":m??void 0,"data-max":l,...c,ref:a})})});is.displayName=pe;var ls="ProgressIndicator",os=d.forwardRef((s,a)=>{const{__scopeProgress:r,...t}=s,i=Pa(ls,r);return e.jsx(E.div,{"data-state":cs(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...t,ref:a})});os.displayName=ls;function Aa(s,a){return`${Math.round(s/a*100)}%`}function cs(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function ae(s){return typeof s=="number"}function De(s){return ae(s)&&!isNaN(s)&&s>0}function ke(s,a){return ae(s)&&!isNaN(s)&&s<=a&&s>=0}function Ia(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ge}\`.`}function Da(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ge} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ds=is,ka=os;const ms=d.forwardRef(({className:s,value:a,...r},t)=>e.jsx(ds,{ref:t,className:C("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(ka,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));ms.displayName=ds.displayName;function Fa({usage:s}){if(!s)return null;const{ordersUsed:a,extraOrdersUsed:r,extraOrdersCost:t,currentBill:i}=s,n=a+r;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Usage"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your current billing period usage"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx(I,{children:e.jsxs(_,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Orders"}),e.jsx(ms,{value:a,max:100,className:"mt-2"})]})}),e.jsx(I,{children:e.jsxs(_,{className:"pt-6",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",i.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current Bill"}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Extra orders cost: £",t.toFixed(2)]})]})})]})]})}function Ea(){const{profile:s,isSubscriptionDialogOpen:a,closeSubscriptionDialog:r,isLoading:t}=D(),i=s==null?void 0:s.subscription,n=(s==null?void 0:s.subscriptionUsage)||null;return e.jsx(de,{open:a,onOpenChange:r,children:e.jsxs(me,{className:"h-full w-full",children:[i?e.jsxs(Na,{defaultValue:"overview",className:"w-full",children:[e.jsxs(ns,{className:"w-full grid grid-cols-3",children:[e.jsx(Z,{value:"overview",children:"Overview"}),e.jsx(Z,{value:"usage",children:"Usage"}),e.jsx(Z,{value:"billing",children:"Billing"})]}),e.jsx(ee,{value:"overview",className:"mt-4",children:e.jsx(Ca,{subscription:i})}),e.jsx(ee,{value:"usage",className:"mt-4",children:e.jsx(Fa,{usage:n})}),e.jsx(ee,{value:"billing",className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Billing Information"}),e.jsx("div",{className:"rounded-lg border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Extra Orders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost per additional order after included limit"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[i.pricePerExtraOrder," ",i.currency]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per order"})]})]})})]})})]}):e.jsx(ba,{plans:[],isLoading:t}),e.jsx(zs,{children:e.jsx(j,{onClick:r,children:"Close"})})]})})}function Ta({subscription:s}){return s?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Plan"}),e.jsx("span",{className:"font-medium",children:s.plan})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx("span",{className:"font-medium capitalize",children:s.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Orders Included"}),e.jsx("span",{className:"font-medium",children:s.includedOrders})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Extra Order Price"}),e.jsxs("span",{className:"font-medium",children:[oe(s.pricePerExtraOrder,s.currency)," per order"]})]}),s.currentPeriodEnd&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Current Period Ends"}),e.jsx("span",{className:"font-medium",children:new Date(s.currentPeriodEnd).toLocaleDateString()})]})]}):e.jsx("div",{className:"text-center text-muted-foreground",children:"No active subscription"})}function La(){const{subscription:s,isLoading:a}=D();return a||!s?null:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Subscription"})}),e.jsx(Ta,{subscription:s})]})}function Wa(){const s=fs(),{isAuthenticated:a}=Fe(),{profile:r,error:t,isLoading:i,isProfileComplete:n,isInitialized:c,initialize:l,clearError:m,openProfileDialog:o,openSubscriptionDialog:x,isProfileDialogOpen:u,fetchProfile:v,isSubscriptionDialogOpen:T}=D();return d.useEffect(()=>{v().catch(console.error)},[]),d.useEffect(()=>{if(!a){s("/auth/login");return}c||l().catch(console.error)},[a,c]),a?i&&!c?e.jsx(re,{children:e.jsx("div",{className:"flex h-[calc(100vh-4rem)] items-center justify-center",children:e.jsx(K,{size:40})})}):!r||!n?e.jsx(re,{children:e.jsxs("div",{className:"container mx-auto space-y-4 px-4 py-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h1",{className:"text-xl font-bold md:text-2xl",children:"Complete Your Profile"})}),e.jsx(Ae,{})]})}):e.jsx(re,{children:e.jsxs("div",{className:"container mx-auto space-y-6 p-4 md:p-8 md:pt-6 max-h-[calc(100vh-12rem)]",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Profile"})})}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(pa,{}),e.jsx(j,{onClick:()=>o(),className:"w-full",children:"Update Profile"})]})}),e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(La,{}),e.jsx(j,{onClick:()=>x(),className:"w-full",children:"Subscription Details"})]})})]}),e.jsx(Ae,{}),e.jsx(Ea,{}),e.jsx(Us,{open:!!t,onOpenChange:()=>m(),title:"Error",description:t||"An error occurred"})]})}):null}export{Wa as Profile};
