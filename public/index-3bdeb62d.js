import{c as $,b as y,d as R,r as g,j as e,e as b,B as ee}from"./main-99bb4b09.js";import{C as L,a as P,j as n,X as se,b as z,P as O,S as q,B as J,c as j,d as N,e as w,M as H,f as v,J as W,g as te,h as T,i as ae,k as re,u as ie,l as ce,L as le,O as ne}from"./badge-e5e69992.js";import{D as U,a as V,b as X,c as u,d as G,P as de}from"./dropdown-menu-b3a63304.js";import{B as x,a as oe,I as me}from"./loading-spinner-1f4ff308.js";import{E as K}from"./ellipsis-vertical-2febadca.js";import{P as Q}from"./phone-ade08aae.js";import{M as xe}from"./mail-9deaecef.js";import{S as m}from"./skeleton-e5d5cc1c.js";import{U as he}from"./user-2488036d.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],pe=$("Building",ue);function fe(){var _,M,F,E,B;const{getJobSiteById:t,isDetailsDialogOpen:c,setIsDetailsDialogOpen:i,currentJobSite:a,jobSites:l,isLoading:d,updateJobSite:o,setIsJobSiteDialogOpen:p,resetJobSiteForm:h,setJobSiteForm:r}=y(),{setIsOrderDialogOpen:f,updateNewOrderForm:D,resetNewOrderForm:I}=R();g.useEffect(()=>{c&&(a!=null&&a._id)&&t(a._id)},[c,a==null?void 0:a._id,t]);const s=l.find(k=>k._id===(a==null?void 0:a._id)),C=async()=>{if(s)try{await o(s._id,{...s,isActive:!s.isActive}),b.success("Job site status updated successfully")}catch{b.error("Failed to update job site status")}},S=()=>{if(!s)return;h();const{_id:k,...Y}=s.contact,{_id:ye,...Z}=s.deliveryInstructions||{};r({_id:s._id,name:s.name,address:s.address,contact:Y,deliveryInstructions:Z,isActive:s.isActive,preferredSuppliers:s.preferredSuppliers}),i(!1),p(!0)},A=()=>{s&&(I(),D({jobSiteId:s._id,jobSiteName:s.name}),i(!1),f(!0))};return!s&&!d?e.jsx(L,{open:c,onOpenChange:i,children:e.jsxs(P,{className:"flex h-full max-w-full flex-col gap-0 border-none p-0 sm:h-auto sm:max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:n.detailsDialog.title}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>i(!1),children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-4",children:e.jsx("p",{children:"No job site data available."})}),e.jsx(z,{className:"px-6 py-4",children:e.jsx(x,{onClick:()=>i(!1),children:n.actions.close})})]})}):e.jsx(L,{open:c,onOpenChange:i,children:e.jsxs(P,{className:"flex h-full max-w-full flex-col gap-0 border-none p-0 sm:h-auto sm:max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:n.detailsDialog.title}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(U,{children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx(K,{className:"h-5 w-5"})})}),e.jsxs(X,{align:"end",children:[e.jsxs(u,{onClick:C,children:[s!=null&&s.isActive?"Deactivate":"Activate"," Job Site"]}),e.jsx(u,{onClick:S,children:"Edit Details"}),e.jsx(G,{}),e.jsx(u,{onClick:A,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Create New Order"]})})]})]})})]}),e.jsx(q,{className:"flex-grow",children:d?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(oe,{size:40})}):s?e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated ",new Date(s.updatedAt).toLocaleDateString()]})]}),e.jsx(J,{variant:s.isActive?"default":"secondary",className:"px-3 py-1",children:s.isActive?n.status.active:n.status.inactive})]}),e.jsxs(j,{className:"border-muted bg-card/50",children:[e.jsx(N,{children:e.jsxs(w,{className:"flex items-center text-base",children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),n.form.address]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium",children:(_=s.address)==null?void 0:_.streetAddress}),e.jsxs("p",{className:"text-muted-foreground",children:[(M=s.address)==null?void 0:M.city,", ",(F=s.address)==null?void 0:F.region," ",(E=s.address)==null?void 0:E.postalCode]}),e.jsx("p",{className:"text-muted-foreground",children:(B=s.address)==null?void 0:B.country})]})})]}),s.contact&&e.jsxs(j,{className:"border-muted bg-card/50",children:[e.jsx(N,{children:e.jsxs(w,{className:"flex items-center text-base",children:[e.jsx(pe,{className:"mr-2 h-5 w-5"}),n.detailsDialog.contactPerson]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.contact.name}),s.contact.title&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.contact.title})]}),s.contact.phone&&e.jsxs("p",{className:"flex items-center text-sm",children:[e.jsx(Q,{className:"mr-2 h-4 w-4 text-muted-foreground"}),s.contact.phone]}),s.contact.email&&e.jsxs("p",{className:"flex items-center text-sm",children:[e.jsx(xe,{className:"mr-2 h-4 w-4 text-muted-foreground"}),s.contact.email]})]})})]}),s.deliveryInstructions&&e.jsxs(j,{className:"border-muted bg-card/50",children:[e.jsx(N,{children:e.jsx(w,{className:"text-base",children:n.form.notes})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[s.deliveryInstructions.accessInstructions&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-1 text-sm font-medium",children:"Access Instructions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.deliveryInstructions.accessInstructions})]}),s.deliveryInstructions.deliveryHours&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-1 text-sm font-medium",children:"Delivery Hours"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.deliveryInstructions.deliveryHours})]}),s.deliveryInstructions.specialRequirements&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-1 text-sm font-medium",children:"Special Requirements"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.deliveryInstructions.specialRequirements})]})]})})]})]}):e.jsx("div",{className:"p-4",children:e.jsx("p",{children:"No job site data available."})})}),e.jsx(z,{className:"border-t bg-muted/40 px-6 py-4",children:e.jsx(x,{onClick:()=>i(!1),children:n.actions.close})})]})})}function je({jobSite:t,onSelect:c}){const{updateJobSite:i,resetJobSiteForm:a,setJobSiteForm:l,setIsDetailsDialogOpen:d,setIsJobSiteDialogOpen:o}=y(),{setIsOrderDialogOpen:p,updateNewOrderForm:h,resetNewOrderForm:r}=R(),f=async()=>{try{await i(t._id,{...t,isActive:!t.isActive}),b.success("Job site status updated successfully")}catch{b.error("Failed to update job site status")}},D=()=>{if(!t)return;a();const{_id:s,...C}=t.contact,{_id:S,...A}=t.deliveryInstructions||{};l({_id:t._id,name:t.name,address:t.address,contact:C,deliveryInstructions:A,isActive:t.isActive,preferredSuppliers:t.preferredSuppliers}),d(!1),o(!0)},I=()=>{t&&(r(),h({jobSiteId:t._id,jobSiteName:t.name}),d(!1),p(!0))};return e.jsxs(j,{className:"group relative overflow-hidden transition-all hover:shadow-md",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(w,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ee,{className:"h-5 w-5 text-muted-foreground"}),t.name]}),e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),t.address.streetAddress,", ",t.address.city]})]}),e.jsxs(U,{children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx(K,{className:"h-4 w-4"})})}),e.jsxs(X,{align:"end",children:[e.jsxs(u,{onClick:f,children:[t.isActive?"Deactivate":"Activate"," Job Site"]}),e.jsx(u,{onClick:D,children:"Edit Details"}),e.jsx(G,{}),e.jsx(u,{onClick:I,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Create New Order"]})})]})]})]})}),e.jsx(v,{className:"pb-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(he,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:t.contact.name}),t.contact.title&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"â€¢"}),e.jsx("span",{className:"text-muted-foreground",children:t.contact.title})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:t.contact.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{variant:t.isActive?"default":"secondary",className:"px-2 py-0",children:t.isActive?"Active":"Inactive"}),t.orders.length>0&&e.jsxs(J,{variant:"outline",className:"px-2 py-0",children:[t.orders.length," Orders"]})]})]})}),e.jsxs(T,{className:"flex items-center justify-between border-t bg-muted/40 pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ae,{className:"h-4 w-4"}),"Created ",re(new Date(t.createdAt),"MMM d, yyyy")]}),e.jsx(x,{variant:"secondary",size:"sm",onClick:()=>c(t),children:"View Details"})]})]})}function Ne(){return e.jsxs(j,{children:[e.jsx(N,{className:"pb-2",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{className:"h-6 w-48"}),e.jsx(m,{className:"h-4 w-64"})]})})}),e.jsx(v,{className:"pb-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(m,{className:"h-4 w-32"}),e.jsx(m,{className:"h-4 w-48"}),e.jsx(m,{className:"h-5 w-24"})]})}),e.jsxs(T,{className:"flex items-center justify-between border-t pt-3",children:[e.jsx(m,{className:"h-4 w-32"}),e.jsx(m,{className:"h-8 w-24"})]})]})}function ve(){const{jobSites:t,isLoading:c,error:i,fetchJobSites:a,setCurrentJobSite:l,setIsDetailsDialogOpen:d,filterStatus:o}=y();g.useEffect(()=>{a()},[a]);const p=r=>{l({_id:r._id,name:r.name,address:r.address,contact:r.contact,deliveryInstructions:r.deliveryInstructions,isActive:r.isActive,preferredSuppliers:r.preferredSuppliers}),d(!0)};if(i)return e.jsx("div",{className:"flex h-[50vh] items-center justify-center",children:e.jsxs("p",{className:"text-destructive",children:["Error: ",i]})});const h=t.filter(r=>o==="all"?!0:o==="active"?r.isActive:o==="inactive"?!r.isActive:!1);return e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-[80vh]",children:e.jsxs("div",{className:"grid gap-4 p-4 md:grid-cols-2 lg:grid-cols-3",children:[c?Array.from({length:6}).map((r,f)=>e.jsx(Ne,{},f)):h.map(r=>e.jsx(je,{jobSite:r,onSelect:p},r._id)),!c&&h.length===0&&e.jsx("div",{className:"col-span-full flex h-[50vh] items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No job sites found"})})]})}),e.jsx(W,{})]})}function ge(){const{setSearchTerm:t}=y(),[c,i]=g.useState(""),[a]=ie(c,300);return g.useEffect(()=>{t(a)},[a,t]),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(me,{placeholder:"Search job sites...",value:c,onChange:l=>i(l.target.value),className:"pl-8"})]})}function Se(){const{fetchJobSites:t,resetJobSiteForm:c,setIsDetailsDialogOpen:i,setIsJobSiteDialogOpen:a}=y();g.useEffect(()=>{t()},[t]);const l=()=>{c(),i(!1),a(!0)};return e.jsx(le,{children:e.jsxs("div",{className:"container mx-auto space-y-6 p-4 md:p-8 md:pt-6 max-h-[calc(100vh-12rem)]",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Job Sites"}),e.jsxs(x,{onClick:l,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Add Job Site"]})]}),e.jsx("div",{className:"flex justify-center w-full",children:e.jsx(ge,{})})]}),e.jsx("div",{className:"flex flex-col gap-4 h-full overflow-y-auto",children:e.jsx(ve,{})}),e.jsx(W,{}),e.jsx(fe,{}),e.jsx(ne,{}),e.jsx(de,{})]})})}export{Se as JobSites};
